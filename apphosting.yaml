# Settings to manage and configure a Firebase App Hosting backend.
# https://firebase.google.com/docs/app-hosting/configure

runConfig:
  # Increase this value if you'd like to automatically spin up
  # more instances in response to increased traffic.
  maxInstances: 1

# Variables d'environnement publiques (non-secrètes)
env:
  - variable: FROM_EMAIL
    value: contact@dubainegoce.fr
  - variable: NEXT_PUBLIC_APP_URL
    value: https://dubainegoce.fr
  - variable: NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY
    value: pk_test_51Sh5VUCVq6ZxeRDQqWdEHzIAr4pdrMeD2NEDJlKlyH1fWkCa8vArbmm0ac5e14Lp7QMS8nmTmmZXhxs2igElPH2200E624hSqD
  - variable: GEMINI_API_KEY
    value: AIzaSyCCZ3zqMJ-h8sWzV1Cy0FzUIk91sd4ZLow

# This section specifies the secrets that should be exposed to the backend as
# environment variables.
# IMPORTANT: You must create these secrets in Google Cloud Secret Manager.
# Ces secrets doivent correspondre aux clés LIVE de vos services.
secretEnvironmentVariables:
  # --- Secrets Stripe (LIVE) ---
  - key: STRIPE_SECRET_KEY
    # La clé secrète LIVE de Stripe (commence par sk_live_...)
    secret: STRIPE_SECRET_KEY
  - key: STRIPE_WEBHOOK_SECRET
    # La clé de signature du webhook LIVE de Stripe (commence par whsec_...)
    # Attention: Ne pas confondre avec le webhook Resend.
    secret: STRIPE_WEBHOOK_SECRET
  # --- Secrets Resend (LIVE) ---
  - key: RESEND_API_KEY
    # Votre clé API Resend (commence par re_...)
    secret: RESEND_API_KEY
  - key: RESEND_AUDIENCE_ID
    # L'ID de votre audience de newsletter Resend
    secret: RESEND_AUDIENCE_ID
  - key: RESEND_WEBHOOK_SECRET
    # La clé de signature du webhook Resend (commence par whsec_...)
    # Attention: Similaire au format de Stripe, mais provient de Resend.
    secret: RESEND_WEBHOOK_SECRET
headers:
  - # Set a Cache-Control header for all static assets.
    source: /_next/static/**
    headers:
      - key: Cache-Control
        value: public, max-age=31536000, immutable
  - # Add security headers to all responses.
    source: /**
    headers:
      - key: Strict-Transport-Security
        value: max-age=31536000; includeSubDomains; preload
      - key: X-Content-Type-Options
        value: nosniff
      - key: X-Frame-Options
        value: SAMEORIGIN
      - key: X-XSS-Protection
        value: "1; mode=block"
      - key: Referrer-Policy
        value: strict-origin-when-cross-origin
      - key: Content-Security-Policy
        value: >-
          frame-ancestors 'self';
          upgrade-insecure-requests;
